<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>RootCore Packages: /cvmfs/atlas.cern.ch/repo/sw/ASG/AnalysisBase/2.4.28/DiTauMassTools/DiTauMassTools/MissingMassCalculator.h Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="../../index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="../../search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="../../files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="../../globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
<h1>/cvmfs/atlas.cern.ch/repo/sw/ASG/AnalysisBase/2.4.28/DiTauMassTools/DiTauMassTools/MissingMassCalculator.h</h1><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment">&gt;&gt;&gt;&gt;&gt;&gt; MissingMassCalculator</span>
<a name="l00003"></a>00003 <span class="comment">&gt;&gt;&gt;&gt;&gt;&gt; Author: Aliaksandr Pranko (appranko@lbl.gov)</span>
<a name="l00004"></a>00004 <span class="comment">&gt;&gt;&gt;&gt;&gt;&gt; Code developers: David Rousseau (rousseau@lal.in2p3.fr), Dimitris Varouchas (Dimitris.Varouchas@cern.ch)</span>
<a name="l00005"></a>00005 <span class="comment">MissingMassCalculator is designed to reconstruct mass in</span>
<a name="l00006"></a>00006 <span class="comment">events where two particles decay into states with missing ET.</span>
<a name="l00007"></a>00007 <span class="comment">*/</span>
<a name="l00008"></a>00008 <span class="preprocessor">#ifndef MissingMassCalculator_h</span>
<a name="l00009"></a>00009 <span class="preprocessor"></span><span class="preprocessor">#define MissingMassCalculator_h</span>
<a name="l00010"></a>00010 <span class="preprocessor"></span>
<a name="l00011"></a>00011 
<a name="l00012"></a>00012 
<a name="l00013"></a>00013 <span class="preprocessor">#if !defined (__CINT__) || defined (__MAKECINT__)</span>
<a name="l00014"></a>00014 <span class="preprocessor"></span>
<a name="l00015"></a>00015 <span class="preprocessor">#include &lt;TH1.h&gt;</span>
<a name="l00016"></a>00016 <span class="preprocessor">#include &lt;TF1.h&gt;</span>
<a name="l00017"></a>00017 <span class="preprocessor">#include &lt;TMath.h&gt;</span>
<a name="l00018"></a>00018 <span class="preprocessor">#include &lt;TLorentzVector.h&gt;</span>
<a name="l00019"></a>00019 <span class="preprocessor">#include &lt;TVector3.h&gt;</span>
<a name="l00020"></a>00020 <span class="preprocessor">#include &lt;vector&gt;</span>
<a name="l00021"></a>00021 <span class="preprocessor">#include &lt;TObject.h&gt;</span>
<a name="l00022"></a>00022 <span class="preprocessor">#include &lt;TDirectory.h&gt;</span>
<a name="l00023"></a>00023 
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;memory&gt;</span>
<a name="l00025"></a>00025 
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;TRandom2.h&gt;</span>
<a name="l00027"></a>00027 
<a name="l00028"></a>00028 <span class="keyword">class </span>TH1F;
<a name="l00029"></a>00029 
<a name="l00030"></a>00030 
<a name="l00031"></a>00031 <span class="keyword">namespace </span>MMCCalibrationSet 
<a name="l00032"></a>00032 {
<a name="l00033"></a>00033   <span class="keyword">enum</span> e { MMC2011=0, MMC2012, MMC2015, MMC2015HIGHMASS, UPGRADE, LFVMMC2012, MMC2016MC15C, MAXMMCCALIBRATIONSET };
<a name="l00034"></a>00034   <span class="keyword">const</span> std::string name[MAXMMCCALIBRATIONSET]={ <span class="stringliteral">&quot;MMC2011&quot;</span>, <span class="stringliteral">&quot;MMC2012&quot;</span>, <span class="stringliteral">&quot;MMC2015&quot;</span>, <span class="stringliteral">&quot;MMC2015HIGHMASS&quot;</span>, <span class="stringliteral">&quot;UPGRADE&quot;</span>, <span class="stringliteral">&quot;LFVMMC2012&quot;</span>, <span class="stringliteral">&quot;MMC2016MC15C&quot;</span>};
<a name="l00035"></a>00035 }
<a name="l00036"></a>00036 
<a name="l00037"></a>00037 <span class="keyword">namespace </span>MMCFitMethod 
<a name="l00038"></a>00038 {
<a name="l00039"></a>00039   <span class="keyword">enum</span> e { MAXW=0, MLM, MLNU3P,MAX};
<a name="l00040"></a>00040   <span class="keyword">const</span> std::string name[MAX]={ <span class="stringliteral">&quot;MAXW=MaximumWeight&quot;</span>, <span class="stringliteral">&quot;MLM=MostLikelyMass&quot;</span>, <span class="stringliteral">&quot;MLNU3P=MostLikelyNeUtrino3Momentum&quot;</span>};
<a name="l00041"></a>00041   <span class="keyword">const</span> std::string shortName[MAX]={ <span class="stringliteral">&quot;MAXW&quot;</span>, <span class="stringliteral">&quot;MLM&quot;</span>, <span class="stringliteral">&quot;MLNU3P&quot;</span>};
<a name="l00042"></a>00042 }
<a name="l00043"></a>00043 
<a name="l00044"></a>00044 <span class="keyword">namespace </span>WalkStrategy 
<a name="l00045"></a>00045 {
<a name="l00046"></a>00046   <span class="keyword">enum</span> e { GRID=0, RANDOM,RANDOMNONUNIF, MARKOVCHAIN, MAXWALKSTRATEGY };
<a name="l00047"></a>00047 }
<a name="l00048"></a>00048 
<a name="l00049"></a>00049 <span class="keyword">namespace </span>MaxHistStrategy 
<a name="l00050"></a>00050 {
<a name="l00051"></a>00051   <span class="keyword">enum</span> e { MAXBIN=0,MAXBINWINDOW, SLIDINGWINDOW, FIT,MAXMAXHISTSTRATEGY };
<a name="l00052"></a>00052 }
<a name="l00053"></a>00053 
<a name="l00054"></a>00054 
<a name="l00055"></a>00055 <span class="keyword">namespace </span>HistInfo 
<a name="l00056"></a>00056 {
<a name="l00057"></a>00057   <span class="keyword">enum</span> e { PROB=0, INTEGRAL, CHI2, DISCRI, TANTHETA, TANTHETAW, FITLENGTH, RMS, RMSVSDISCRI, MEANBIN, MAXHISTINFO };
<a name="l00058"></a>00058 }
<a name="l00059"></a>00059 
<a name="l00060"></a>00060 
<a name="l00061"></a>00061 
<a name="l00062"></a>00062 <span class="preprocessor">#endif</span>
<a name="l00063"></a>00063 <span class="preprocessor"></span>
<a name="l00064"></a>00064 <span class="comment">/* class MissingMassCalculator: public TObject { */</span>
<a name="l00065"></a><a class="code" href="../../d1/da9/classMissingMassCalculator.html">00065</a> <span class="keyword">class </span><a class="code" href="../../d1/da9/classMissingMassCalculator.html">MissingMassCalculator</a> {
<a name="l00066"></a>00066 
<a name="l00067"></a>00067  <span class="keyword">public</span>:
<a name="l00068"></a>00068   <span class="comment">//DR</span>
<a name="l00069"></a>00069   <span class="comment">/* #if !defined(__CINT__) | defined(__MAKECINT__) */</span>
<a name="l00070"></a>00070   <span class="comment">/* // Define the class for the cint dictionary */</span>
<a name="l00071"></a>00071   <span class="comment">/* ClassDef(MissingMassCalculator,1); */</span>
<a name="l00072"></a>00072   <span class="comment">/* #endif */</span>
<a name="l00073"></a>00073     
<a name="l00074"></a>00074 
<a name="l00075"></a>00075   <span class="comment">// keep the whole list of points</span>
<a name="l00076"></a><a class="code" href="../../d6/d61/structMissingMassCalculator_1_1AllPointsOutputInfo.html">00076</a>   <span class="keyword">struct </span><a class="code" href="../../d6/d61/structMissingMassCalculator_1_1AllPointsOutputInfo.html">AllPointsOutputInfo</a> {
<a name="l00077"></a>00077     std::vector&lt;double&gt; prob;
<a name="l00078"></a>00078     std::vector&lt;double&gt; mtautau;
<a name="l00079"></a>00079     std::vector&lt;double&gt; Phi1;
<a name="l00080"></a>00080     std::vector&lt;double&gt; Phi2;
<a name="l00081"></a>00081     std::vector&lt;double&gt; MEtP;
<a name="l00082"></a>00082     std::vector&lt;double&gt; MEtL;
<a name="l00083"></a>00083     std::vector&lt;double&gt; MEtX;
<a name="l00084"></a>00084     std::vector&lt;double&gt; MEtY;
<a name="l00085"></a>00085     std::vector&lt;double&gt; Mnu1;
<a name="l00086"></a>00086     std::vector&lt;double&gt; Mnu2;
<a name="l00087"></a>00087     std::vector&lt;double&gt; eTau1;
<a name="l00088"></a>00088     std::vector&lt;double&gt; eTau2;
<a name="l00089"></a>00089     std::vector&lt;int&gt; pCode; <span class="comment">// -10 : outside parameter space boundary. 0 no solution. 10 some solutions. +1 if accepted</span>
<a name="l00090"></a>00090     std::vector&lt;int&gt; index;
<a name="l00091"></a>00091   };
<a name="l00092"></a>00092 
<a name="l00093"></a>00093   
<a name="l00094"></a>00094       
<a name="l00095"></a>00095 
<a name="l00096"></a>00096 <span class="keyword">private</span>:
<a name="l00097"></a>00097   <a class="code" href="../../d6/d61/structMissingMassCalculator_1_1AllPointsOutputInfo.html">AllPointsOutputInfo</a> m_aPOI;
<a name="l00098"></a>00098   <span class="keywordtype">int</span> m_apoiIndex;
<a name="l00099"></a>00099 
<a name="l00100"></a>00100   <span class="comment">//---------------- structures</span>
<a name="l00101"></a>00101   <span class="keyword">struct </span>DitauStuff {
<a name="l00102"></a>00102     <span class="keywordtype">double</span> Mditau_best; <span class="comment">// best fitted M(ditau)</span>
<a name="l00103"></a>00103     <span class="keywordtype">double</span> Sign_best;   <span class="comment">// best significance of M(ditau) fit</span>
<a name="l00104"></a>00104     TLorentzVector nutau1;  <span class="comment">// fitted 4-vec for neutrino from tau-1</span>
<a name="l00105"></a>00105     TLorentzVector nutau2;  <span class="comment">// fitted 4-vec for neutrino from tau-2</span>
<a name="l00106"></a>00106     TLorentzVector vistau1;  <span class="comment">// fitted 4-vec for visible tau-1</span>
<a name="l00107"></a>00107     TLorentzVector vistau2;  <span class="comment">// fitted 4-vec for visible tau-2</span>
<a name="l00108"></a>00108     TLorentzVector taufit1;  <span class="comment">// fitted 4-vec for full tau-1</span>
<a name="l00109"></a>00109     TLorentzVector taufit2;  <span class="comment">// fitted 4-vec for full tau-2</span>
<a name="l00110"></a>00110     <span class="keywordtype">double</span> RMSoverMPV;
<a name="l00111"></a>00111   };
<a name="l00112"></a>00112 
<a name="l00113"></a>00113   <span class="keyword">struct </span>InputInfoStuff {
<a name="l00114"></a>00114     TVector2 MetVec;
<a name="l00115"></a>00115     TVector2 detMetVec; <span class="comment">// need to keep separate instead Metvec recalibrated or replaced by -HT</span>
<a name="l00116"></a>00116     TLorentzVector vistau1;
<a name="l00117"></a>00117     TLorentzVector vistau2;
<a name="l00118"></a>00118     <span class="keywordtype">int</span> type_visTau1; <span class="comment">// 0: l, 1:1-prong, 3:3-prong</span>
<a name="l00119"></a>00119     <span class="keywordtype">int</span> type_visTau2;  <span class="comment">// 0: l, 1:1-prong, 3:3-prong</span>
<a name="l00120"></a>00120     <span class="keywordtype">int</span> Nprong_tau1;
<a name="l00121"></a>00121     <span class="keywordtype">int</span> Nprong_tau2;
<a name="l00122"></a>00122     <span class="keywordtype">int</span> dataType;
<a name="l00123"></a>00123     <span class="keywordtype">double</span> METcovphi;
<a name="l00124"></a>00124     <span class="keywordtype">double</span> METsigmaP;
<a name="l00125"></a>00125     <span class="keywordtype">double</span> METsigmaL;
<a name="l00126"></a>00126     <span class="keywordtype">double</span> SumEt;
<a name="l00127"></a>00127     <span class="keywordtype">double</span> sigmaEtau1;
<a name="l00128"></a>00128     <span class="keywordtype">double</span> sigmaEtau2;
<a name="l00129"></a>00129     std::vector&lt;TLorentzVector&gt; jet4vecs;
<a name="l00130"></a>00130     <span class="keywordtype">int</span> Njet25;
<a name="l00131"></a>00131     <span class="keywordtype">double</span> DelPhiTT;
<a name="l00132"></a>00132     <span class="keywordtype">bool</span> allowUseHT;
<a name="l00133"></a>00133     <span class="keywordtype">bool</span> UseHT;
<a name="l00134"></a>00134     <span class="keywordtype">double</span> MHtSigma1; <span class="comment">// sigma of 1st Gaussian in missing Ht resolution</span>
<a name="l00135"></a>00135     <span class="keywordtype">double</span> MHtSigma2; <span class="comment">// sigma of 2nd Gaussian in missing Ht resolution</span>
<a name="l00136"></a>00136     <span class="keywordtype">double</span> MHtGaussFr; <span class="comment">// relative fraction of 2nd Gaussian</span>
<a name="l00137"></a>00137     <span class="keywordtype">double</span> HtOffset; <span class="comment">// HT offset</span>
<a name="l00138"></a>00138 
<a name="l00139"></a>00139   };
<a name="l00140"></a>00140 
<a name="l00141"></a>00141   <span class="keyword">struct </span>OutputInfoStuff {
<a name="l00142"></a>00142     <span class="keywordtype">int</span> FitStatus;
<a name="l00143"></a>00143     <span class="keywordtype">double</span> FitSignificance[MMCFitMethod::MAX];
<a name="l00144"></a>00144     <span class="keywordtype">double</span> FittedMass[MMCFitMethod::MAX];
<a name="l00145"></a>00145     TLorentzVector nuvec1[MMCFitMethod::MAX];
<a name="l00146"></a>00146     TLorentzVector objvec1[MMCFitMethod::MAX];
<a name="l00147"></a>00147     TLorentzVector nuvec2[MMCFitMethod::MAX];
<a name="l00148"></a>00148     TLorentzVector objvec2[MMCFitMethod::MAX];
<a name="l00149"></a>00149     TLorentzVector totalvec[MMCFitMethod::MAX];
<a name="l00150"></a>00150     TVector2 FittedMetVec[MMCFitMethod::MAX];
<a name="l00151"></a>00151     <span class="keywordtype">double</span> RMS2MPV;
<a name="l00152"></a>00152     std::shared_ptr&lt;TH1F&gt; hMfit_all;
<a name="l00153"></a>00153     std::shared_ptr&lt;TH1F&gt; hMfit_allNoWeight;
<a name="l00154"></a>00154     <span class="keywordtype">int</span> NTrials;
<a name="l00155"></a>00155     <span class="keywordtype">int</span> NSuccesses;
<a name="l00156"></a>00156     <span class="keywordtype">int</span> NSolutions;
<a name="l00157"></a>00157     <span class="keywordtype">double</span> SumW;
<a name="l00158"></a>00158     <span class="keywordtype">double</span> AveSolRMS;
<a name="l00159"></a>00159     <span class="keywordtype">bool</span> UseHT;
<a name="l00160"></a>00160   };
<a name="l00161"></a>00161 
<a name="l00162"></a>00162   MMCCalibrationSet::e m_MMCCalibrationSet;
<a name="l00163"></a>00163   <span class="comment">//  WalkStrategy::e walkStrategy;</span>
<a name="l00164"></a>00164   TRandom2 * randomGen;
<a name="l00165"></a>00165   
<a name="l00166"></a>00166   <span class="comment">//SpeedUp static array for efficient access</span>
<a name="l00167"></a>00167   <span class="keyword">static</span> <span class="keywordtype">double</span> fit_param[2][3][6][5];
<a name="l00168"></a>00168   <span class="keyword">static</span> <span class="keywordtype">double</span> ter_sigma_par[2][10][3];
<a name="l00169"></a>00169   <span class="comment">//cache quantities for efficient NuPSolution calculation</span>
<a name="l00170"></a>00170 
<a name="l00171"></a>00171 
<a name="l00172"></a>00172   <span class="keywordtype">int</span> nsolmax,nsolfinalmax;
<a name="l00173"></a>00173   <span class="keywordtype">int</span> m_NiterRandomLocal;
<a name="l00174"></a>00174   <span class="keywordtype">int</span> m_NsucStop;
<a name="l00175"></a>00175   <span class="keywordtype">int</span> m_rmsStop;
<a name="l00176"></a>00176   <span class="keywordtype">double</span> m_meanbinStop;
<a name="l00177"></a>00177   
<a name="l00178"></a>00178 
<a name="l00179"></a>00179 
<a name="l00180"></a>00180   
<a name="l00181"></a>00181   <span class="comment">// these are temporary vectors. Dclared globally to avoid construction/destruction</span>
<a name="l00182"></a>00182   std::vector&lt;TLorentzVector&gt; nuvecsol1;
<a name="l00183"></a>00183   std::vector&lt;TLorentzVector&gt; nuvecsol2;
<a name="l00184"></a>00184 
<a name="l00185"></a>00185   std::vector&lt;TLorentzVector&gt; tauvecsol1;
<a name="l00186"></a>00186   std::vector&lt;TLorentzVector&gt; tauvecsol2;
<a name="l00187"></a>00187   std::vector&lt;double&gt; tauvecprob1;
<a name="l00188"></a>00188   std::vector&lt;double&gt; tauvecprob2;
<a name="l00189"></a>00189 
<a name="l00190"></a>00190   std::vector&lt;TLorentzVector&gt; nuvec1_tmp;
<a name="l00191"></a>00191   std::vector&lt;TLorentzVector&gt; nuvec2_tmp;
<a name="l00192"></a>00192 
<a name="l00193"></a>00193   TVector2 m_metVec;
<a name="l00194"></a>00194   TLorentzVector tautau_tmp;
<a name="l00195"></a>00195   TLorentzVector tlv_tmp;
<a name="l00196"></a>00196 
<a name="l00197"></a>00197   
<a name="l00198"></a>00198   <span class="comment">//  std::vector&lt;TLorentzVector&gt; tauvecsol1;</span>
<a name="l00199"></a>00199   <span class="comment">// std::vector&lt;TLorentzVector&gt; tauvecsol2;</span>
<a name="l00200"></a>00200   <span class="keywordtype">bool</span> debugThisIteration;
<a name="l00201"></a>00201   
<a name="l00202"></a>00202   <span class="keywordtype">int</span> nCallprobCalculatorV9fast;
<a name="l00203"></a>00203   
<a name="l00204"></a>00204 
<a name="l00205"></a>00205   <span class="keywordtype">int</span> iter1,iter2,iter3,iter4,iter5,iang1low,iang1high,iang2low,iang2high;
<a name="l00206"></a>00206   <span class="keywordtype">int</span> iterTheta3d;
<a name="l00207"></a>00207   
<a name="l00208"></a>00208   <span class="keywordtype">double</span> prob_tmp;
<a name="l00209"></a>00209   
<a name="l00210"></a>00210   <span class="keywordtype">double</span> totalProbSum;
<a name="l00211"></a>00211   <span class="keywordtype">double</span> mtautauSum;
<a name="l00212"></a>00212 
<a name="l00213"></a>00213   <span class="keywordtype">int</span> m_seed;
<a name="l00214"></a>00214   <span class="comment">// data member for the spaceWalker approach</span>
<a name="l00215"></a>00215 
<a name="l00216"></a>00216   <span class="keywordtype">int</span> m_iter0;
<a name="l00217"></a>00217   <span class="keywordtype">int</span> m_iterNuPV3;
<a name="l00218"></a>00218   <span class="keywordtype">int</span> m_testptn1;
<a name="l00219"></a>00219   <span class="keywordtype">int</span> m_testptn2;
<a name="l00220"></a>00220   <span class="keywordtype">int</span> m_testdiscri1;
<a name="l00221"></a>00221   <span class="keywordtype">int</span> m_testdiscri2;
<a name="l00222"></a>00222   <span class="keywordtype">int</span> m_iterNsuc;
<a name="l00223"></a>00223   <span class="keywordtype">bool</span> m_switch1;
<a name="l00224"></a>00224   <span class="keywordtype">bool</span> m_switch2;
<a name="l00225"></a>00225 
<a name="l00226"></a>00226   <span class="keywordtype">bool</span> m_meanbinToBeEvaluated;
<a name="l00227"></a>00227   
<a name="l00228"></a>00228   <span class="keywordtype">int</span> m_markovCountDuplicate;
<a name="l00229"></a>00229   <span class="keywordtype">int</span> m_markovNFullScan;
<a name="l00230"></a>00230   <span class="keywordtype">int</span> m_markovNRejectNoSol;
<a name="l00231"></a>00231   <span class="keywordtype">int</span> m_markovNRejectMetropolis;
<a name="l00232"></a>00232   <span class="keywordtype">int</span> m_markovNAccept;
<a name="l00233"></a>00233 
<a name="l00234"></a>00234   <span class="keywordtype">double</span> m_PrintmMaxError;
<a name="l00235"></a>00235   <span class="keywordtype">double</span> m_PrintmMeanError;
<a name="l00236"></a>00236   <span class="keywordtype">double</span> m_PrintmInvWidth2Error;
<a name="l00237"></a>00237 
<a name="l00238"></a>00238   <span class="keywordtype">double</span> m_ProposalTryMEt;
<a name="l00239"></a>00239   <span class="keywordtype">double</span> m_ProposalTryPhi;
<a name="l00240"></a>00240   <span class="keywordtype">double</span> m_ProposalTryMnu;
<a name="l00241"></a>00241   <span class="keywordtype">double</span> m_ProposalTryEtau;
<a name="l00242"></a>00242 
<a name="l00243"></a>00243 
<a name="l00244"></a>00244   <span class="keywordtype">double</span> m_mTau,m_mTau2;
<a name="l00245"></a>00245   <span class="keywordtype">double</span> m_MEtL,m_MEtP,m_Phi1,m_Phi2,m_Mnu1,m_Mnu2;
<a name="l00246"></a>00246   <span class="keywordtype">double</span> m_eTau1, m_eTau2;
<a name="l00247"></a>00247   <span class="keywordtype">double</span> m_eTau10, m_eTau20;
<a name="l00248"></a>00248   <span class="keywordtype">double</span> m_MEtL0,m_MEtP0,m_Phi10,m_Phi20,m_Mnu10,m_Mnu20;
<a name="l00249"></a>00249   <span class="keywordtype">double</span> m_MEtLMin,m_MEtPMin,m_Phi1Min,m_Phi2Min,m_Mnu1Min,m_Mnu2Min;
<a name="l00250"></a>00250   <span class="keywordtype">double</span> m_MEtLMax,m_MEtPMax,m_Phi1Max,m_Phi2Max,m_Mnu1Max,m_Mnu2Max;
<a name="l00251"></a>00251   <span class="keywordtype">double</span> m_MEtLStep,m_MEtPStep,m_Phi1Step,m_Phi2Step,m_Mnu1Step,m_Mnu2Step;
<a name="l00252"></a>00252   <span class="keywordtype">double</span> m_MEtLRange,m_MEtPRange,m_Phi1Range,m_Phi2Range,m_Mnu1Range,m_Mnu2Range;
<a name="l00253"></a>00253   <span class="keywordtype">double</span> m_MEtProposal,m_PhiProposal,m_MnuProposal;
<a name="l00254"></a>00254   <span class="keywordtype">double</span> m_eTau1Proposal,m_eTau2Proposal;
<a name="l00255"></a>00255 
<a name="l00256"></a>00256   <span class="keywordtype">double</span> m_MEtX, m_MEtY,m_MEtT;
<a name="l00257"></a>00257   <span class="keywordtype">double</span> m_eTau1Min,m_eTau1Max,m_eTau1Range;
<a name="l00258"></a>00258   <span class="keywordtype">double</span> m_eTau2Min,m_eTau2Max,m_eTau2Range;
<a name="l00259"></a>00259   <span class="keywordtype">bool</span> fullParamSpaceScan;
<a name="l00260"></a>00260   <span class="keywordtype">bool</span> m_Mnu1Exclude;
<a name="l00261"></a>00261   <span class="keywordtype">int</span> m_nsolOld;
<a name="l00262"></a>00262   std::vector&lt;double&gt;   m_probFinalSolOldVec;
<a name="l00263"></a>00263   std::vector&lt;double&gt;   m_mtautauFinalSolOldVec;
<a name="l00264"></a>00264   std::vector&lt;TLorentzVector&gt;  m_nu1FinalSolOldVec;
<a name="l00265"></a>00265   std::vector&lt;TLorentzVector&gt;  m_nu2FinalSolOldVec;
<a name="l00266"></a>00266 
<a name="l00267"></a>00267   <span class="keywordtype">int</span> m_nsol;
<a name="l00268"></a>00268   std::vector&lt;double&gt;   m_probFinalSolVec;
<a name="l00269"></a>00269   std::vector&lt;double&gt;   m_mtautauFinalSolVec;
<a name="l00270"></a>00270   std::vector&lt;TLorentzVector&gt;  m_nu1FinalSolVec;
<a name="l00271"></a>00271   std::vector&lt;TLorentzVector&gt;  m_nu2FinalSolVec;
<a name="l00272"></a>00272 
<a name="l00273"></a>00273 
<a name="l00274"></a>00274   <span class="keywordtype">double</span> m_Mnu1ExcludeMin,m_Mnu1ExcludeMax,m_Mnu1ExcludeRange;
<a name="l00275"></a>00275   <span class="keywordtype">double</span> m_Mnu1XMin,m_Mnu1XMax, m_Mnu1XRange;
<a name="l00276"></a>00276   <span class="keywordtype">double</span> m_walkWeight;
<a name="l00277"></a>00277   <span class="keywordtype">double</span> m_cosPhi1, m_cosPhi2, m_sinPhi1, m_sinPhi2;
<a name="l00278"></a>00278   
<a name="l00279"></a>00279   <span class="keywordtype">bool</span> m_scanMnu1,m_scanMnu2;
<a name="l00280"></a>00280   <span class="keywordtype">bool</span> m_scanEtau1,m_scanEtau2;
<a name="l00281"></a>00281 
<a name="l00282"></a>00282   TLorentzVector m_tauVec1,m_tauVec2;
<a name="l00283"></a>00283   <span class="keywordtype">double</span> m_tauVec1Phi, m_tauVec2Phi;
<a name="l00284"></a>00284   <span class="keywordtype">double</span> m_tauVec1M, m_tauVec2M;
<a name="l00285"></a>00285   <span class="keywordtype">double</span> m_tauVec1Px, m_tauVec1Py, m_tauVec1Pz;
<a name="l00286"></a>00286   <span class="keywordtype">double</span> m_tauVec2Px, m_tauVec2Py, m_tauVec2Pz;
<a name="l00287"></a>00287   <span class="keywordtype">double</span> m_tauVec1P, m_tauVec2P;
<a name="l00288"></a>00288   <span class="keywordtype">double</span> m_tauVec1E;
<a name="l00289"></a>00289   <span class="keywordtype">double</span> m_tauVec2E;
<a name="l00290"></a>00290   <span class="keywordtype">double</span> m_m2Nu1;
<a name="l00291"></a>00291   <span class="keywordtype">double</span> m_m2Nu2;
<a name="l00292"></a>00292   <span class="keywordtype">double</span> m_ET2v1;
<a name="l00293"></a>00293   <span class="keywordtype">double</span> m_ET2v2;
<a name="l00294"></a>00294   <span class="keywordtype">double</span> m_E2v1;
<a name="l00295"></a>00295   <span class="keywordtype">double</span> m_E2v2;
<a name="l00296"></a>00296   <span class="keywordtype">double</span> m_Ev2;
<a name="l00297"></a>00297   <span class="keywordtype">double</span> m_Ev1;
<a name="l00298"></a>00298   <span class="keywordtype">double</span> m_metCovPhiCos,m_metCovPhiSin;
<a name="l00299"></a>00299   <span class="keywordtype">double</span> m_Mvis,m_Meff;
<a name="l00300"></a>00300   <span class="keywordtype">double</span> m_DetMEt;
<a name="l00301"></a>00301   <span class="keywordtype">double</span> m_inputMEtX,m_inputMEtY,m_inputMEtT;
<a name="l00302"></a>00302   <span class="keywordtype">double</span> m_HtOffset;
<a name="l00303"></a>00303   <span class="keywordtype">bool</span> reRunWithBestMET;
<a name="l00304"></a>00304   
<a name="l00305"></a>00305   <span class="comment">//--- define histograms for histogram method</span>
<a name="l00306"></a>00306   <span class="comment">//--- upper limits need to be revisied in the future!!! It may be not enough for some analyses</span>
<a name="l00307"></a>00307   std::shared_ptr&lt;TH1F&gt; fMfit_all;
<a name="l00308"></a>00308   std::shared_ptr&lt;TH1F&gt; fMfit_allNoWeight;
<a name="l00309"></a>00309   
<a name="l00310"></a>00310   std::shared_ptr&lt;TH1F&gt; fPXfit1;
<a name="l00311"></a>00311   std::shared_ptr&lt;TH1F&gt; fPYfit1;
<a name="l00312"></a>00312   std::shared_ptr&lt;TH1F&gt; fPZfit1;
<a name="l00313"></a>00313   std::shared_ptr&lt;TH1F&gt; fPXfit2;
<a name="l00314"></a>00314   std::shared_ptr&lt;TH1F&gt; fPYfit2;
<a name="l00315"></a>00315   std::shared_ptr&lt;TH1F&gt; fPZfit2;
<a name="l00316"></a>00316 
<a name="l00317"></a>00317   TF1 *m_fFitting;
<a name="l00318"></a>00318 
<a name="l00319"></a>00319   TH1F* fPhi1;
<a name="l00320"></a>00320   TH1F* fPhi2;
<a name="l00321"></a>00321   TH1F* fMnu1;
<a name="l00322"></a>00322   TH1F* fMnu2;
<a name="l00323"></a>00323   TH1F* fMetx;
<a name="l00324"></a>00324   TH1F* fMety;
<a name="l00325"></a>00325   TH1F* fTheta3D;
<a name="l00326"></a>00326   TH1F* fTauProb;
<a name="l00327"></a>00327 
<a name="l00328"></a>00328   <span class="comment">// for intermediate calc</span>
<a name="l00329"></a>00329   TLorentzVector TLVdummy;
<a name="l00330"></a>00330 
<a name="l00331"></a>00331   <span class="comment">//---------------- protected variables</span>
<a name="l00332"></a>00332   DitauStuff fDitauStuffFit; <span class="comment">// results based on fit method</span>
<a name="l00333"></a>00333   DitauStuff fDitauStuffHisto; <span class="comment">// results based on histo method</span>
<a name="l00334"></a>00334   InputInfoStuff rawInput; <span class="comment">// raw input </span>
<a name="l00335"></a>00335   InputInfoStuff preparedInput; <span class="comment">// corrected input (DR should maybe not be a datamember)</span>
<a name="l00336"></a>00336   OutputInfoStuff OutputInfo; <span class="comment">// output info</span>
<a name="l00337"></a>00337 
<a name="l00338"></a>00338   <span class="keywordtype">int</span> fUseVerbose; <span class="comment">// code to turn ON printouts for debugging</span>
<a name="l00339"></a>00339   <span class="keywordtype">bool</span> fSpeedStudy; <span class="comment">// code to turn ON speed study</span>
<a name="l00340"></a>00340   <span class="keywordtype">int</span> AlgorithmVersion; <span class="comment">// version of the algorithm</span>
<a name="l00341"></a>00341   <span class="keywordtype">int</span> SearchMode; <span class="comment">// search Mode: 0=di-tau, 1=WW, 2=W-&gt;tau+nu</span>
<a name="l00342"></a>00342   <span class="keywordtype">int</span> fApplyMassScale; <span class="comment">// switch to apply mass scale correction</span>
<a name="l00343"></a>00343   <span class="keywordtype">int</span> fUseTailCleanup; <span class="comment">// switch to apply tail clean-up</span>
<a name="l00344"></a>00344   <span class="keywordtype">int</span> fUseTauProbability; <span class="comment">// switch to apply TauProbability</span>
<a name="l00345"></a>00345   <span class="keywordtype">int</span> fUseMnuProbability; <span class="comment">// switch to apply MnuProbability</span>
<a name="l00346"></a>00346   <span class="keywordtype">int</span> fUseDefaults; <span class="comment">// switch to control defaults: 1== use defaults, 0== don&apos;t use defaults (useful for studies) </span>
<a name="l00347"></a>00347   <span class="keywordtype">int</span> fUseEfficiencyRecovery; <span class="comment">// switch to turn ON/OFF re-fit in order to recover efficiency</span>
<a name="l00348"></a>00348 
<a name="l00349"></a>00349   <span class="keywordtype">int</span> Niter_fit1; <span class="comment">// number of iterations for dR-dPhi scan </span>
<a name="l00350"></a>00350   <span class="keywordtype">int</span> Niter_fit2; <span class="comment">// number of iterations for MET-scan </span>
<a name="l00351"></a>00351   <span class="keywordtype">int</span> Niter_fit3; <span class="comment">// number of iterations for Mnu-scan </span>
<a name="l00352"></a>00352   <span class="keywordtype">int</span> NiterRandom; <span class="comment">// number of random iterations (for lh, multiply or divide by 10 for ll and hh)</span>
<a name="l00353"></a>00353   <span class="keywordtype">int</span> NsucStop;
<a name="l00354"></a>00354   <span class="keywordtype">int</span> RMSStop;
<a name="l00355"></a>00355   <span class="keywordtype">int</span> RndmSeedAltering; <span class="comment">// reset seed (not necessary by default)</span>
<a name="l00356"></a>00356 
<a name="l00357"></a>00357   <span class="keywordtype">int</span> InputReorder; <span class="comment">// flag for input re-order</span>
<a name="l00358"></a>00358   <span class="keywordtype">int</span> LFVmode; <span class="comment">// flag to determine which LFV decay to be reconstructed: 0=H-&gt;e+tau(mu) or 1=H-&gt;mu+tau(e) </span>
<a name="l00359"></a>00359 
<a name="l00360"></a>00360   <span class="keywordtype">int</span> fJERsyst; <span class="comment">// switch for JER systematics</span>
<a name="l00361"></a>00361   <span class="keywordtype">int</span> METresSyst; <span class="comment">// switch to turn on/off MET resolution systematics</span>
<a name="l00362"></a>00362   <span class="keywordtype">double</span> dTheta3d_binMin; <span class="comment">// minimal step size for dTheta3D</span>
<a name="l00363"></a>00363   <span class="keywordtype">double</span> dTheta3d_binMax; <span class="comment">// maximum step size for dTheta3D</span>
<a name="l00364"></a>00364   <span class="keywordtype">double</span> dRmax_tau; <span class="comment">// maximum dR(nu-visTau)</span>
<a name="l00365"></a>00365   <span class="keywordtype">double</span> Nsigma_METscan,Nsigma_METscan2,Nsigma_METscan_ll,Nsigma_METscan_lh,Nsigma_METscan_hh; <span class="comment">// number of sigmas for MET-scan</span>
<a name="l00366"></a>00366 
<a name="l00367"></a>00367   <span class="keywordtype">double</span> beamEnergy; <span class="comment">// beam energy (Tevatron=980, LHC-1=3500.0) </span>
<a name="l00368"></a>00368   <span class="keywordtype">int</span> METScanScheme; <span class="comment">// MET-scan scheme: 0- use JER; 1- use simple sumEt &amp; missingHt for Njet=0 events in (lep-had) </span>
<a name="l00369"></a>00369   <span class="keywordtype">double</span> MnuScanRange; <span class="comment">// range of M(nunu) scan; M(nunu) range can be affected by selection cuts</span>
<a name="l00370"></a>00370   
<a name="l00371"></a>00371   <span class="keywordtype">bool</span> fUseDphiLL; <span class="comment">//for leplep</span>
<a name="l00372"></a>00372 
<a name="l00373"></a>00373   <span class="comment">//---------------- protected functions</span>
<a name="l00374"></a>00374   <span class="keywordtype">void</span> ClearDitauStuff(DitauStuff &amp;fStuff);
<a name="l00375"></a>00375   <span class="keywordtype">void</span> ClearInputStuff();
<a name="l00376"></a>00376   <span class="keywordtype">void</span> ClearOutputStuff();
<a name="l00377"></a>00377   <span class="keywordtype">void</span> DoOutputInfo();
<a name="l00378"></a>00378   <span class="keywordtype">void</span> DoMetResolution(InputInfoStuff &amp;fStuff);
<a name="l00379"></a>00379   <span class="keywordtype">void</span> PrintInputInfo(<span class="keyword">const</span> InputInfoStuff &amp; fStuff);
<a name="l00380"></a>00380   <span class="keywordtype">void</span> PrintOtherInput();
<a name="l00381"></a>00381   <span class="keywordtype">void</span> PrintResults();
<a name="l00382"></a>00382   <span class="keywordtype">void</span> FinalizeInputStuff();<span class="comment">//const InputInfoStuff &amp;rawInput, InputInfoStuff &amp;preparedInput);</span>
<a name="l00383"></a>00383   <span class="keywordtype">int</span> NuPsolution(TVector2 met_vec, <span class="keywordtype">double</span> theta1, <span class="keywordtype">double</span> phi1, 
<a name="l00384"></a>00384           <span class="keywordtype">double</span> theta2, <span class="keywordtype">double</span> phi2, <span class="keywordtype">double</span> &amp;P1, <span class="keywordtype">double</span> &amp;P2); <span class="comment">// keep this version for simple tests</span>
<a name="l00385"></a>00385 
<a name="l00386"></a>00386 
<a name="l00387"></a>00387   <span class="keyword">inline</span> <span class="keywordtype">int</span> NuPsolutionV3(<span class="keyword">const</span> <span class="keywordtype">double</span> &amp; mNu1, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp; mNu2, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp; phi1, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp; phi2, 
<a name="l00388"></a>00388                <span class="keywordtype">int</span> &amp; nsol1, <span class="keywordtype">int</span> &amp; nsol2);
<a name="l00389"></a>00389 
<a name="l00390"></a>00390   <span class="keyword">inline</span> <span class="keywordtype">int</span> NuPsolutionLFV(<span class="keyword">const</span> TVector2 &amp; met_vec, <span class="keyword">const</span> TLorentzVector &amp; tau, 
<a name="l00391"></a>00391                 <span class="keyword">const</span> <span class="keywordtype">double</span> &amp; m_nu, std::vector&lt;TLorentzVector&gt; &amp;nu_vec);
<a name="l00392"></a>00392 
<a name="l00393"></a>00393   
<a name="l00394"></a>00394   <span class="keyword">inline</span> <span class="keywordtype">double</span> tauSigmaE(<span class="keyword">const</span> TLorentzVector &amp; tauVec, <span class="keyword">const</span> <span class="keywordtype">int</span> tauType );
<a name="l00395"></a>00395   <span class="keyword">inline</span> <span class="keywordtype">double</span> dTheta3Dparam(<span class="keyword">const</span> <span class="keywordtype">int</span> &amp; parInd, <span class="keyword">const</span> <span class="keywordtype">int</span> &amp; tau_type, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp; P_tau,<span class="keyword">const</span> <span class="keywordtype">double</span> *par); 
<a name="l00396"></a>00396 
<a name="l00397"></a>00397   <span class="comment">//DR public:  </span>
<a name="l00398"></a>00398   <span class="keywordtype">double</span> dTheta3d_probabilityFast(<span class="keyword">const</span> <span class="keywordtype">int</span> &amp; tau_type,<span class="keyword">const</span> <span class="keywordtype">double</span> &amp; dTheta3d,<span class="keyword">const</span> <span class="keywordtype">double</span> &amp; P_tau);
<a name="l00399"></a>00399  <span class="keyword">protected</span>:
<a name="l00400"></a>00400   <span class="keyword">inline</span> <span class="keywordtype">double</span> myDelThetaHadFunc(<span class="keywordtype">double</span> *x, <span class="keywordtype">double</span> *par);
<a name="l00401"></a>00401   <span class="keyword">inline</span> <span class="keywordtype">double</span> myDelThetaLepFunc(<span class="keywordtype">double</span> *x, <span class="keywordtype">double</span> *par);
<a name="l00402"></a>00402 
<a name="l00403"></a>00403   <span class="keyword">inline</span> <span class="keywordtype">double</span> MetProbability(<span class="keyword">const</span> <span class="keywordtype">double</span> &amp; met1,<span class="keyword">const</span>  <span class="keywordtype">double</span> &amp; met2,<span class="keyword">const</span>  <span class="keywordtype">double</span> &amp; MetSigma1, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp; MetSigma2);
<a name="l00404"></a>00404 
<a name="l00405"></a>00405   <span class="keyword">inline</span> <span class="keywordtype">double</span> MHtProbability(<span class="keyword">const</span> <span class="keywordtype">double</span> &amp; d_mhtX, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp; d_mhtY, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp; mht, 
<a name="l00406"></a>00406                    <span class="keyword">const</span> <span class="keywordtype">double</span> &amp; trueMetGuess, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp; mht_offset);
<a name="l00407"></a>00407   <span class="keyword">inline</span> <span class="keywordtype">double</span> MHtProbabilityHH(<span class="keyword">const</span> <span class="keywordtype">double</span> &amp; d_mhtX, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp; d_mhtY, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp; mht, 
<a name="l00408"></a>00408                  <span class="keyword">const</span> <span class="keywordtype">double</span> &amp; trueMetGuess, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp; mht_offset);
<a name="l00409"></a>00409 
<a name="l00410"></a>00410   <span class="keyword">inline</span> <span class="keywordtype">double</span> mEtAndTauProbability();
<a name="l00411"></a>00411 
<a name="l00412"></a>00412   <span class="keyword">inline</span> <span class="keywordtype">double</span> TERProbabilitySimple(<span class="keywordtype">int</span> tau_type, <span class="keyword">const</span> TLorentzVector &amp; vec, 
<a name="l00413"></a>00413                      <span class="keyword">const</span> <span class="keywordtype">double</span> &amp; Pt_scan);
<a name="l00414"></a>00414   <span class="keyword">inline</span> <span class="keywordtype">double</span> TERSimpleSigma(<span class="keywordtype">int</span> tau_type, <span class="keyword">const</span> TLorentzVector &amp; vec);
<a name="l00415"></a>00415 
<a name="l00416"></a>00416   <span class="keyword">inline</span> <span class="keywordtype">void</span> swapTLVPointers (TLorentzVector * &amp; p1,TLorentzVector * &amp; p2);
<a name="l00417"></a>00417   <span class="keyword">inline</span> <span class="keywordtype">double</span> Angle(<span class="keyword">const</span> TLorentzVector &amp; vec1, <span class="keyword">const</span> TLorentzVector &amp; vec2);
<a name="l00418"></a>00418   <span class="keyword">inline</span> <span class="keywordtype">double</span> AngularProbability(TLorentzVector nu_vec, TLorentzVector vis_vec, <span class="keywordtype">int</span> decayType);
<a name="l00419"></a>00419   <span class="keyword">inline</span> <span class="keywordtype">int</span> CheckSolutions(TLorentzVector nu_vec, TLorentzVector vis_vec, <span class="keywordtype">int</span> decayType);
<a name="l00420"></a>00420   <span class="keyword">inline</span> <span class="keywordtype">double</span> MnuProbability(<span class="keywordtype">double</span> mnu, <span class="keywordtype">double</span> binsize);
<a name="l00421"></a>00421   <span class="keyword">inline</span> <span class="keywordtype">double</span> MnuProbability(<span class="keywordtype">double</span> mnu);
<a name="l00422"></a>00422   <span class="keyword">inline</span> <span class="keywordtype">double</span> ResonanceProbability(TLorentzVector vec1, TLorentzVector vec2);
<a name="l00423"></a>00423   <span class="keyword">inline</span> <span class="keywordtype">int</span> TailCleanUp(<span class="keyword">const</span> <span class="keywordtype">int</span> &amp; type1, <span class="keyword">const</span> TLorentzVector &amp; vis1, <span class="keyword">const</span> TLorentzVector &amp; nu1, 
<a name="l00424"></a>00424              <span class="keyword">const</span> <span class="keywordtype">int</span> &amp; type2, <span class="keyword">const</span> TLorentzVector &amp; vis2, <span class="keyword">const</span> TLorentzVector &amp; nu2, 
<a name="l00425"></a>00425              <span class="keyword">const</span> <span class="keywordtype">double</span> &amp; mmc_mass, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp; vis_mass, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp; eff_mass, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp; dphiTT);
<a name="l00426"></a>00426 
<a name="l00427"></a>00427   <span class="keyword">inline</span> <span class="keywordtype">double</span> TauProbability(<span class="keyword">const</span> <span class="keywordtype">int</span> &amp; type1, <span class="keyword">const</span> TLorentzVector &amp; vis1, <span class="keyword">const</span> TLorentzVector &amp; nu1, 
<a name="l00428"></a>00428                    <span class="keyword">const</span> <span class="keywordtype">int</span> &amp; type2, <span class="keyword">const</span> TLorentzVector &amp; vis2, <span class="keyword">const</span> TLorentzVector &amp; nu2);
<a name="l00429"></a>00429   <span class="keyword">inline</span> <span class="keywordtype">double</span> TauProbability(<span class="keyword">const</span> <span class="keywordtype">int</span> &amp; type1, <span class="keyword">const</span> TLorentzVector &amp; vis1, <span class="keyword">const</span> TLorentzVector &amp; nu1, 
<a name="l00430"></a>00430                    <span class="keyword">const</span> <span class="keywordtype">int</span> &amp; type2, <span class="keyword">const</span> TLorentzVector &amp; vis2, <span class="keyword">const</span> TLorentzVector &amp; nu2, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp; detmet);
<a name="l00431"></a>00431   <span class="keyword">inline</span> <span class="keywordtype">double</span> TauProbabilityMatrix(<span class="keyword">const</span> <span class="keywordtype">int</span> &amp; type1, <span class="keyword">const</span> TLorentzVector &amp; vis1, <span class="keyword">const</span> TLorentzVector &amp; nu1, 
<a name="l00432"></a>00432                      <span class="keyword">const</span> <span class="keywordtype">int</span> &amp; type2, <span class="keyword">const</span> TLorentzVector &amp; vis2, <span class="keyword">const</span> TLorentzVector &amp; nu2);
<a name="l00433"></a>00433   <span class="keyword">inline</span> <span class="keywordtype">double</span> TauProbabilityLFV(<span class="keyword">const</span> <span class="keywordtype">int</span> &amp; type1, <span class="keyword">const</span> TLorentzVector &amp; vis1, <span class="keyword">const</span> TLorentzVector &amp; nu1);
<a name="l00434"></a>00434   <span class="keyword">inline</span> <span class="keywordtype">double</span> MaxDelPhi(<span class="keywordtype">int</span> tau_type, <span class="keywordtype">double</span> Pvis);
<a name="l00435"></a>00435 
<a name="l00436"></a>00436   <span class="keyword">inline</span> <span class="keywordtype">int</span> refineSolutions (          <span class="keyword">const</span> <span class="keywordtype">double</span> &amp; M_nu1, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp; M_nu2,
<a name="l00437"></a>00437                         <span class="keyword">const</span> <span class="keywordtype">int</span> nsol1, <span class="keyword">const</span> <span class="keywordtype">int</span> nsol2,
<a name="l00438"></a>00438                   <span class="keyword">const</span> <span class="keywordtype">double</span> &amp; Mvis, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp; Meff);
<a name="l00439"></a>00439 
<a name="l00440"></a>00440   <span class="keyword">inline</span> <span class="keywordtype">double</span> mT(<span class="keyword">const</span> TLorentzVector &amp; vec,<span class="keyword">const</span> TVector2 &amp; met_vec);
<a name="l00441"></a>00441   
<a name="l00442"></a>00442   
<a name="l00443"></a>00443   <span class="keyword">inline</span> <span class="keywordtype">void</span> handleSolutions();
<a name="l00444"></a>00444 
<a name="l00445"></a>00445   <span class="keyword">inline</span> <span class="keywordtype">double</span> MassScale(<span class="keywordtype">int</span> method, <span class="keywordtype">double</span> mass, <span class="keyword">const</span> <span class="keywordtype">int</span> &amp; tau_type1, <span class="keyword">const</span> <span class="keywordtype">int</span> &amp; tau_type2);
<a name="l00446"></a>00446 
<a name="l00447"></a>00447   
<a name="l00448"></a>00448   <span class="comment">// factor out parameter space walking and probablity computing</span>
<a name="l00449"></a>00449   <span class="keyword">inline</span>  <span class="keywordtype">int</span> DitauMassCalculatorV9walk();
<a name="l00450"></a>00450   
<a name="l00451"></a>00451 
<a name="l00452"></a>00452   <span class="comment">// Calculates mass of lep+tau system in LFV X-&gt;lep+tau decays</span>
<a name="l00453"></a>00453 
<a name="l00454"></a>00454   <span class="comment">// It is based on DitauMassCalculatorV9, not optimized for speed yet, simple phase-space scan   </span>
<a name="l00455"></a>00455   <span class="keyword">inline</span> <span class="keywordtype">int</span> DitauMassCalculatorV9lfv();
<a name="l00456"></a>00456 
<a name="l00457"></a>00457 
<a name="l00458"></a>00458   
<a name="l00459"></a>00459   <span class="comment">// only compute probability</span>
<a name="l00460"></a>00460   <span class="keyword">inline</span> <span class="keywordtype">int</span> probCalculatorV9fast(
<a name="l00461"></a>00461                   <span class="keyword">const</span> <span class="keywordtype">double</span> &amp; phi1, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp; phi2, 
<a name="l00462"></a>00462                   <span class="keyword">const</span> <span class="keywordtype">double</span> &amp; M_nu1, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp; M_nu2);
<a name="l00463"></a>00463   
<a name="l00464"></a>00464   <span class="comment">// initialize the walker</span>
<a name="l00465"></a>00465   <span class="keyword">inline</span>  <span class="keywordtype">void</span> SpaceWalkerInit();
<a name="l00466"></a>00466   
<a name="l00467"></a>00467   <span class="comment">//walk the walker</span>
<a name="l00468"></a>00468   <span class="keyword">inline</span> <span class="keywordtype">bool</span> SpaceWalkerWalk();
<a name="l00469"></a>00469   
<a name="l00470"></a>00470   <span class="comment">//update tau kinematics if tau energy scan </span>
<a name="l00471"></a>00471   <span class="keyword">inline</span> <span class="keywordtype">void</span> updateTauKine();
<a name="l00472"></a>00472 
<a name="l00473"></a>00473 
<a name="l00474"></a>00474   <span class="keyword">inline</span> <span class="keywordtype">bool</span> precomputeCache();
<a name="l00475"></a>00475   
<a name="l00476"></a>00476 
<a name="l00477"></a>00477   <span class="keyword">inline</span> <span class="keywordtype">bool</span> updateDouble  (<span class="keyword">const</span> <span class="keywordtype">double</span> in, <span class="keywordtype">double</span> &amp; out) ;
<a name="l00478"></a>00478   <span class="keyword">inline</span> <span class="keywordtype">bool</span> checkMEtInRange  () ;
<a name="l00479"></a>00479   <span class="keyword">inline</span> <span class="keywordtype">bool</span> checkAllParamInRange  () ;
<a name="l00480"></a>00480   <span class="keyword">inline</span> <span class="keywordtype">double</span> fixPhiRange (<span class="keyword">const</span> <span class="keywordtype">double</span> &amp; phi);
<a name="l00481"></a>00481 <span class="comment">// fast (but approximate) calculation of sin and cos</span>
<a name="l00482"></a>00482   <span class="keyword">inline</span> <span class="keywordtype">void</span> fastSinCos (<span class="keyword">const</span> <span class="keywordtype">double</span> &amp; phi, <span class="keywordtype">double</span> &amp; sinPhi, <span class="keywordtype">double</span> &amp; cosPhi);
<a name="l00483"></a>00483   
<a name="l00484"></a>00484 
<a name="l00485"></a>00485   <span class="comment">//----------------------------------------------</span>
<a name="l00486"></a>00486   <span class="comment">//</span>
<a name="l00487"></a>00487   <span class="comment">// &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;   Public methods &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt; </span>
<a name="l00488"></a>00488   <span class="comment">//</span>
<a name="l00489"></a>00489   <span class="comment">//______________________________________________</span>
<a name="l00490"></a>00490 
<a name="l00491"></a>00491 <span class="keyword">public</span>:
<a name="l00492"></a>00492 
<a name="l00493"></a>00493   ~<a class="code" href="../../d1/da9/classMissingMassCalculator.html">MissingMassCalculator</a>() ;
<a name="l00494"></a>00494 
<a name="l00495"></a>00495   <a class="code" href="../../d1/da9/classMissingMassCalculator.html#a1831f389483007adaeeb7c673742a657">MissingMassCalculator</a>() ;
<a name="l00496"></a>00496 
<a name="l00497"></a>00497 
<a name="l00498"></a>00498   <span class="keywordtype">int</span> RunMissingMassCalculator();
<a name="l00499"></a>00499   
<a name="l00500"></a>00500   <span class="comment">//-------- Set Input Parameters</span>
<a name="l00501"></a>00501   <span class="keywordtype">void</span> SetCalibrationSet( MMCCalibrationSet::e aset) { m_MMCCalibrationSet=aset; }
<a name="l00502"></a>00502   <span class="keywordtype">void</span> SetSearchMode(<span class="keywordtype">int</span> val) { SearchMode=val; }
<a name="l00503"></a>00503   <span class="keywordtype">void</span> SetUseVerbose(<span class="keywordtype">int</span> val) { fUseVerbose=val; }
<a name="l00504"></a>00504   <span class="keywordtype">void</span> SetSpeedStudy(<span class="keywordtype">int</span> val) { fSpeedStudy=val; }
<a name="l00505"></a>00505   <span class="keywordtype">void</span> SetAlgorithmVersion(<span class="keywordtype">int</span> val) { AlgorithmVersion=val; }
<a name="l00506"></a>00506   <span class="keywordtype">void</span> SetUseTauProbability(<span class="keywordtype">int</span> val) { fUseTauProbability=val; }
<a name="l00507"></a>00507   <span class="keywordtype">void</span> SetUseMnuProbability(<span class="keywordtype">int</span> val) { fUseMnuProbability=val; }
<a name="l00508"></a>00508   <span class="keywordtype">void</span> SetUseDefaults(<span class="keywordtype">int</span> val) { fUseDefaults=val; }
<a name="l00509"></a>00509   <span class="keywordtype">void</span> SetUseEfficiencyRecovery(<span class="keywordtype">int</span> val) { fUseEfficiencyRecovery=val; }
<a name="l00510"></a>00510 
<a name="l00511"></a>00511   <span class="keywordtype">void</span> SetNiterFit1(<span class="keywordtype">int</span> val) { Niter_fit1=val; } <span class="comment">// number of iterations per loop in dPhi loop</span>
<a name="l00512"></a>00512   <span class="keywordtype">void</span> SetNiterFit2(<span class="keywordtype">int</span> val) { Niter_fit2=val; } <span class="comment">// number of iterations per loop in MET loop</span>
<a name="l00513"></a>00513   <span class="keywordtype">void</span> SetNiterFit3(<span class="keywordtype">int</span> val) { Niter_fit3=val; } <span class="comment">// number of iterations per loop in Mnu loop</span>
<a name="l00514"></a>00514   <span class="keywordtype">void</span> SetNiterRandom(<span class="keywordtype">int</span> val) { NiterRandom=val; } <span class="comment">// number of random iterations</span>
<a name="l00515"></a>00515   <span class="keywordtype">void</span> SetNsucStop(<span class="keywordtype">int</span> val) { NsucStop=val; } <span class="comment">// Arrest criteria for Nsuccesses</span>
<a name="l00516"></a>00516   <span class="keywordtype">void</span> SetRMSStop(<span class="keywordtype">int</span> val) { RMSStop=val;}
<a name="l00517"></a>00517   <span class="keywordtype">void</span> SetMeanbinStop(<span class="keywordtype">double</span> val) {m_meanbinStop=val;}
<a name="l00518"></a>00518   <span class="keywordtype">void</span> SetRndmSeedAltering(<span class="keywordtype">int</span> val) { RndmSeedAltering=val; } <span class="comment">// number of iterations per loop in Mnu loop</span>
<a name="l00519"></a>00519   <span class="keywordtype">void</span> SetMaxDRtau(<span class="keywordtype">double</span> val) { dRmax_tau=val; } <span class="comment">// max value of dR</span>
<a name="l00520"></a>00520   <span class="keywordtype">void</span> SetNsigmaMETscan(<span class="keywordtype">double</span> val) { Nsigma_METscan=val; } <span class="comment">// number of sigma&apos;s for MET-scan</span>
<a name="l00521"></a>00521   <span class="keywordtype">void</span> SetNsigmaMETscan_ll(<span class="keywordtype">double</span> val) { Nsigma_METscan_ll=val; } <span class="comment">// number of sigma&apos;s for MET-scan in ll events</span>
<a name="l00522"></a>00522   <span class="keywordtype">void</span> SetNsigmaMETscan_lh(<span class="keywordtype">double</span> val) { Nsigma_METscan_lh=val; } <span class="comment">// number of sigma&apos;s for MET-scan in lh events</span>
<a name="l00523"></a>00523   <span class="keywordtype">void</span> SetNsigmaMETscan_hh(<span class="keywordtype">double</span> val) { Nsigma_METscan_hh=val; } <span class="comment">// number of sigma&apos;s for MET-scan in hh events</span>
<a name="l00524"></a>00524   <span class="keywordtype">void</span> SetBeamEnergy(<span class="keywordtype">double</span> val) { beamEnergy=val; } <span class="comment">// beam energy</span>
<a name="l00525"></a>00525   <span class="keywordtype">void</span> SetdTheta3d_binMax(<span class="keywordtype">double</span> val) { dTheta3d_binMax=val; } <span class="comment">// maximum step size for dTheta3D</span>
<a name="l00526"></a>00526   <span class="keywordtype">void</span> SetdTheta3d_binMin(<span class="keywordtype">double</span> val) { dTheta3d_binMin=val; } <span class="comment">// minimal step size for dTheta3D</span>
<a name="l00527"></a>00527 
<a name="l00528"></a>00528   <span class="keywordtype">void</span> SetMetVec(<span class="keyword">const</span> TVector2 &amp; vec);
<a name="l00529"></a>00529   <span class="keywordtype">void</span> SetVisTauVec(<span class="keywordtype">int</span> i, <span class="keyword">const</span> TLorentzVector &amp; vec);
<a name="l00530"></a>00530   <span class="keywordtype">void</span> SetVisTauType(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> tautype);
<a name="l00531"></a>00531   <span class="keywordtype">void</span> SetNprong(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> nprong);
<a name="l00532"></a>00532   <span class="keywordtype">void</span> SetSumEt(<span class="keywordtype">double</span> sumEt);
<a name="l00533"></a>00533   <span class="keywordtype">void</span> SetIsData(<span class="keywordtype">int</span> val);
<a name="l00534"></a>00534   <span class="keywordtype">void</span> SetMetCovariance(<span class="keywordtype">double</span> varX, <span class="keywordtype">double</span> varY, <span class="keywordtype">double</span> varXY); <span class="comment">// MET covariance matrix</span>
<a name="l00535"></a>00535   <span class="keywordtype">void</span> SetMetScanParams(<span class="keywordtype">double</span> phi, <span class="keywordtype">double</span> sigmaP, <span class="keywordtype">double</span> sigmaL); <span class="comment">// MET ellipse (deduced from MetCovariance)</span>
<a name="l00536"></a>00536   <span class="keywordtype">void</span> SetMetScanParamsUE(<span class="keywordtype">double</span> sumEt, <span class="keywordtype">double</span> phi_scan=0.0, <span class="keywordtype">int</span> data_code=0);
<a name="l00537"></a>00537   <span class="keywordtype">void</span> SetMetScanParamsJets(std::vector&lt;TLorentzVector&gt; jets);
<a name="l00538"></a>00538   <span class="keywordtype">void</span> SetJERsyst(<span class="keywordtype">int</span> val) { fJERsyst=val; }
<a name="l00539"></a>00539   <span class="keywordtype">void</span> SetMETresSyst(<span class="keywordtype">int</span> val) { METresSyst=val; } <span class="comment">// MET resolution systematics: +/-1 sigma</span>
<a name="l00540"></a>00540   <span class="keywordtype">void</span> SetApplyMassScale(<span class="keywordtype">int</span> val) { fApplyMassScale=val; } 
<a name="l00541"></a>00541   <span class="keywordtype">void</span> SetUseTailCleanup(<span class="keywordtype">int</span> val) { fUseTailCleanup=val; }
<a name="l00542"></a>00542   <span class="keywordtype">void</span> SetNjet25(<span class="keywordtype">int</span> val);
<a name="l00543"></a>00543   <span class="keywordtype">void</span> SetAllowUseHT(<span class="keywordtype">bool</span> allowUseHT) { rawInput.allowUseHT=allowUseHT;}
<a name="l00544"></a>00544   <span class="keywordtype">void</span> SetMETScanScheme(<span class="keywordtype">int</span> val) { METScanScheme=val; }
<a name="l00545"></a>00545 
<a name="l00546"></a>00546   <span class="keywordtype">void</span> SetMHtSigma1(<span class="keywordtype">double</span> val) { rawInput.MHtSigma1=val; }
<a name="l00547"></a>00547   <span class="keywordtype">void</span> SetMHtSigma2(<span class="keywordtype">double</span> val) { rawInput.MHtSigma2=val; } 
<a name="l00548"></a>00548   <span class="keywordtype">void</span> SetMHtGaussFr(<span class="keywordtype">double</span> val) { rawInput.MHtGaussFr=val; }
<a name="l00549"></a>00549   <span class="keywordtype">void</span> SetMnuScanRange(<span class="keywordtype">double</span> val) { MnuScanRange=val; }
<a name="l00550"></a>00550 
<a name="l00551"></a>00551   <span class="keywordtype">void</span> SetProposalTryMEt(<span class="keywordtype">double</span> val) {m_ProposalTryMEt=val; }
<a name="l00552"></a>00552   <span class="keywordtype">void</span> SetProposalTryPhi(<span class="keywordtype">double</span> val) {m_ProposalTryPhi=val;}
<a name="l00553"></a>00553   <span class="keywordtype">void</span> SetProposalTryMnu(<span class="keywordtype">double</span> val) {m_ProposalTryMnu=val;}
<a name="l00554"></a>00554   <span class="keywordtype">void</span> SetProposalTryEtau(<span class="keywordtype">double</span> val) {m_ProposalTryEtau=val;}
<a name="l00555"></a>00555 
<a name="l00556"></a>00556   <span class="comment">// added by Tomas Davidek</span>
<a name="l00557"></a>00557   <span class="keywordtype">void</span> SetUseDphiLL(<span class="keywordtype">bool</span> val) {fUseDphiLL = val;}
<a name="l00558"></a>00558 
<a name="l00559"></a>00559   <span class="keywordtype">void</span> SetLFVmode(<span class="keywordtype">int</span> val) { LFVmode=val; }
<a name="l00560"></a>00560   MMCCalibrationSet::e GetCalibrationSet() { <span class="keywordflow">return</span> m_MMCCalibrationSet; }
<a name="l00561"></a>00561   <span class="keywordtype">int</span> GetNiterFit1()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> Niter_fit1; } <span class="comment">// number of iterations per loop in dPhi loop</span>
<a name="l00562"></a>00562   <span class="keywordtype">int</span> GetNiterFit2()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> Niter_fit2; } <span class="comment">// number of iterations per loop in MET loop</span>
<a name="l00563"></a>00563   <span class="keywordtype">int</span> GetNiterFit3()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> Niter_fit3; } <span class="comment">// number of iterations per loop in Mnu loop</span>
<a name="l00564"></a>00564   <span class="keywordtype">int</span> GetNiterRandom()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m_NiterRandomLocal; } <span class="comment">// number of random iterations</span>
<a name="l00565"></a>00565 
<a name="l00566"></a>00566   <span class="keywordtype">int</span> GetNsucStop()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> NsucStop; } <span class="comment">// Arrest criteria for NSuc</span>
<a name="l00567"></a>00567   <span class="keywordtype">int</span> GetRMSStop()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> RMSStop; }
<a name="l00568"></a>00568   <span class="keywordtype">double</span> GetMeanbinStop()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m_meanbinStop;}
<a name="l00569"></a>00569   <span class="keywordtype">int</span> GetRndmSeedAltering()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> RndmSeedAltering; } <span class="comment">// number of iterations per loop in Mnu loop</span>
<a name="l00570"></a>00570 
<a name="l00571"></a>00571   <span class="keywordtype">bool</span> GetUseHT()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> OutputInfo.UseHT; } <span class="comment">// if use HT</span>
<a name="l00572"></a>00572 
<a name="l00573"></a>00573   <span class="keywordtype">int</span> GetMarkovCountDuplicate()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m_markovCountDuplicate; }
<a name="l00574"></a>00574   <span class="keywordtype">int</span> GetMarkovNRejectNoSol()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m_markovNRejectNoSol;}
<a name="l00575"></a>00575   <span class="keywordtype">int</span> GetMarkovNRejectMetropolis()<span class="keyword"> const </span>{<span class="keywordflow">return</span> m_markovNRejectMetropolis;}
<a name="l00576"></a>00576   <span class="keywordtype">int</span> GetMarkovNAccept()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m_markovNAccept; }
<a name="l00577"></a>00577   <span class="keywordtype">int</span> GetMarkovNFullscan()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m_markovNFullScan;}
<a name="l00578"></a>00578   <span class="keywordtype">double</span> GetProposalTryMEt()<span class="keyword"> const </span>{<span class="keywordflow">return</span> m_ProposalTryMEt;}
<a name="l00579"></a>00579   <span class="keywordtype">double</span> GetProposalTryPhi()<span class="keyword"> const </span>{<span class="keywordflow">return</span> m_ProposalTryPhi;}
<a name="l00580"></a>00580   <span class="keywordtype">double</span> GetProposalTryMnu()<span class="keyword"> const </span>{<span class="keywordflow">return</span> m_ProposalTryMnu;}
<a name="l00581"></a>00581   <span class="keywordtype">double</span> GetProposalTryEtau()<span class="keyword"> const </span>{<span class="keywordflow">return</span> m_ProposalTryEtau;}
<a name="l00582"></a>00582 
<a name="l00583"></a>00583 
<a name="l00584"></a>00584   <span class="keywordtype">double</span> GetmMaxError()<span class="keyword"> const </span>{<span class="keywordflow">return</span> m_PrintmMaxError;}
<a name="l00585"></a>00585   <span class="keywordtype">double</span> GetmMeanError()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m_PrintmMeanError;}
<a name="l00586"></a>00586   <span class="keywordtype">double</span> GetmInvWidth2Error()<span class="keyword"> const </span>{<span class="keywordflow">return</span> m_PrintmInvWidth2Error;}
<a name="l00587"></a>00587 
<a name="l00588"></a>00588 
<a name="l00589"></a>00589   <span class="comment">//-------- Get results;</span>
<a name="l00590"></a>00590   <span class="keywordtype">int</span> GetFitStatus(); <span class="comment">// return fit status</span>
<a name="l00591"></a>00591   <span class="keywordtype">double</span> GetFittedMass(<span class="keywordtype">int</span> fitcode); <span class="comment">// returns fitted Mass</span>
<a name="l00592"></a>00592   std::shared_ptr&lt;TH1F&gt; GetMassHistogram(); <span class="comment">// return mass histogram</span>
<a name="l00593"></a>00593   std::shared_ptr&lt;TH1F&gt; GetMassHistogramNoWeight(); <span class="comment">// return mass histogram without weights</span>
<a name="l00594"></a>00594   <span class="keywordtype">int</span> GetNTrials();<span class="comment">// total number of point scanned</span>
<a name="l00595"></a>00595   <span class="keywordtype">int</span> GetNSuccesses();<span class="comment">// total number of point with at least 1 solutions</span>
<a name="l00596"></a>00596   <span class="keywordtype">int</span> GetNSolutions();<span class="comment">// total number of solutions </span>
<a name="l00597"></a>00597   <span class="keywordtype">double</span> GetSumW(); <span class="comment">// sum of weights</span>
<a name="l00598"></a>00598   <span class="keywordtype">double</span> GetAveSolRMS(); <span class="comment">// ave RMS of solutions (for one event)</span>
<a name="l00599"></a>00599 
<a name="l00600"></a>00600   <span class="keywordtype">double</span> GetRms2Mpv(); <span class="comment">// returns RMS/MPV according to histogram method</span>
<a name="l00601"></a>00601   TLorentzVector GetNeutrino4vec(<span class="keywordtype">int</span> fitcode, <span class="keywordtype">int</span> ind); <span class="comment">// returns neutrino 4-vec</span>
<a name="l00602"></a>00602   <span class="keywordtype">double</span> GetFitSignificance(<span class="keywordtype">int</span> fitcode); <span class="comment">// returns fit significance</span>
<a name="l00603"></a>00603   TLorentzVector GetTau4vec(<span class="keywordtype">int</span> fitcode, <span class="keywordtype">int</span> ind); <span class="comment">// returns full tau 4-vec</span>
<a name="l00604"></a>00604   TLorentzVector GetResonanceVec(<span class="keywordtype">int</span> fitcode); <span class="comment">// returns 4-vec for resonance </span>
<a name="l00605"></a>00605   TVector2 GetFittedMetVec(<span class="keywordtype">int</span> fitcode); <span class="comment">// returns 2-vec for fitted MET</span>
<a name="l00606"></a>00606   <span class="keyword">const</span> AllPointsOutputInfo &amp; GetAllPointsOutputInfo() { <span class="keywordflow">return</span> m_aPOI;};
<a name="l00607"></a>00607   <span class="keywordtype">int</span> StandardCollApprox(<span class="keyword">const</span> TLorentzVector &amp; tau_vec1, <span class="keyword">const</span> TLorentzVector &amp; tau_vec2, <span class="keyword">const</span> TVector2 &amp; met_vec, <span class="keywordtype">double</span> &amp;Mrec); <span class="comment">// standard collinear approximation</span>
<a name="l00608"></a>00608   <span class="comment">// compute maximum from histo</span>
<a name="l00609"></a>00609   <span class="comment">//  double maxFromHist(TH1F * theHist, double &amp; prob, double &amp; h_integral, double &amp; h_chi2, double &amp; h_discri, double &amp; h_tantheta, double &amp; h_tanthetaw, double &amp; h_fitlength, double &amp; h_rms, double &amp; h_rmsvsdiscri, const MaxHistStrategy::e maxHistStrategy=MaxHistStrategy::FIT,const int winHalfWidth=2,bool debug=false);</span>
<a name="l00610"></a>00610   Double_t maxFitting(Double_t *x, Double_t *par);
<a name="l00611"></a>00611   
<a name="l00612"></a>00612   <span class="keywordtype">double</span> maxFromHist(TH1F *theHist, std::vector&lt;double&gt; &amp; histInfo, <span class="keyword">const</span> MaxHistStrategy::e maxHistStrategy=MaxHistStrategy::FIT,<span class="keyword">const</span> <span class="keywordtype">int</span> winHalfWidth=2,<span class="keywordtype">bool</span> debug=<span class="keyword">false</span>);
<a name="l00613"></a>00613   <span class="keywordtype">double</span> maxFromHist(<span class="keyword">const</span> std::shared_ptr&lt;TH1F&gt;&amp; theHist, std::vector&lt;double&gt; &amp; histInfo, <span class="keyword">const</span> MaxHistStrategy::e maxHistStrategy=MaxHistStrategy::FIT,<span class="keyword">const</span> <span class="keywordtype">int</span> winHalfWidth=2,<span class="keywordtype">bool</span> debug=<span class="keyword">false</span>) {
<a name="l00614"></a>00614     <span class="keywordflow">return</span> maxFromHist(theHist.get(), histInfo, maxHistStrategy, winHalfWidth, debug);
<a name="l00615"></a>00615   }
<a name="l00616"></a>00616 
<a name="l00617"></a>00617     <span class="comment">// missing removed interfaces to turn on LFV code</span>
<a name="l00618"></a>00618     TVector2 metvec_tmp;
<a name="l00619"></a>00619     <span class="keyword">inline</span> <span class="keywordtype">double</span> dTheta3DLimit(<span class="keyword">const</span> <span class="keywordtype">int</span> &amp; tau_type, <span class="keyword">const</span> <span class="keywordtype">int</span> &amp; limit_code,<span class="keyword">const</span> <span class="keywordtype">double</span> &amp; P_tau);
<a name="l00620"></a>00620 
<a name="l00621"></a>00621 };
<a name="l00622"></a>00622 
<a name="l00623"></a>00623 <span class="preprocessor">#endif</span>
</pre></div></div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&nbsp;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr size="1"/><address style="text-align: right;"><small>Generated on 14 Apr 2017 for RootCore Packages by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
