<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>RootCore Packages: /cvmfs/atlas.cern.ch/repo/sw/ASG/AnalysisBase/2.4.31/CxxUtils/CxxUtils/fpcompare.h File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">RootCore Packages
   &#160;<span id="projectnumber">2.4.31</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_6389297dfc687cd70752e8ae0b42586a.html">cvmfs</a></li><li class="navelem"><a class="el" href="../../dir_62892ac20956129f9eb822bab0336060.html">atlas.cern.ch</a></li><li class="navelem"><a class="el" href="../../dir_5ab4f853507b29eb302fccade2c88498.html">repo</a></li><li class="navelem"><a class="el" href="../../dir_ada49346adeed4120cdd9652d3e45109.html">sw</a></li><li class="navelem"><a class="el" href="../../dir_e58915b0aa9b467606f66665c240947f.html">ASG</a></li><li class="navelem"><a class="el" href="../../dir_a8b55eac85754bca9c4f1c73437a2720.html">AnalysisBase</a></li><li class="navelem"><a class="el" href="../../dir_f287f45277d6fd24c09469e8bfda983b.html">2.4.31</a></li><li class="navelem"><a class="el" href="../../dir_c7bf6e064a8c1b1ee2505a93a999400d.html">CxxUtils</a></li><li class="navelem"><a class="el" href="../../dir_dcfa5032ce2ea64f11a06d7730eede8c.html">CxxUtils</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#namespaces">Namespaces</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">fpcompare.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Workaround x86 precision issues for FP inequality comparisons.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;cmath&gt;</code><br/>
<code>#include &lt;functional&gt;</code><br/>
</div>
<p><a href="../../df/df0/fpcompare_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d29/structCxxUtils_1_1fpcompare__fn_1_1equal.html">CxxUtils::fpcompare_fn::equal</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compare two FP numbers, working around x87 precision issues.  <a href="../../dd/d29/structCxxUtils_1_1fpcompare__fn_1_1equal.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d7a/structCxxUtils_1_1fpcompare__fn_1_1equalf.html">CxxUtils::fpcompare_fn::equalf</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compare two FP numbers, working around x87 precision issues.  <a href="../../d4/d7a/structCxxUtils_1_1fpcompare__fn_1_1equalf.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d03/structCxxUtils_1_1fpcompare__fn_1_1greater.html">CxxUtils::fpcompare_fn::greater</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compare two FP numbers, working around x87 precision issues.  <a href="../../d4/d03/structCxxUtils_1_1fpcompare__fn_1_1greater.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddd/structCxxUtils_1_1fpcompare__fn_1_1greaterf.html">CxxUtils::fpcompare_fn::greaterf</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compare two FP numbers, working around x87 precision issues.  <a href="../../d3/ddd/structCxxUtils_1_1fpcompare__fn_1_1greaterf.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/ded/structCxxUtils_1_1fpcompare__fn_1_1less.html">CxxUtils::fpcompare_fn::less</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compare two FP numbers, working around x87 precision issues.  <a href="../../dc/ded/structCxxUtils_1_1fpcompare__fn_1_1less.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d91/structCxxUtils_1_1fpcompare__fn_1_1lessf.html">CxxUtils::fpcompare_fn::lessf</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compare two FP numbers, working around x87 precision issues.  <a href="../../d2/d91/structCxxUtils_1_1fpcompare__fn_1_1lessf.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/db2/structCxxUtils_1_1fpcompare__fn_1_1greater__equal.html">CxxUtils::fpcompare_fn::greater_equal</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compare two FP numbers, working around x87 precision issues.  <a href="../../d7/db2/structCxxUtils_1_1fpcompare__fn_1_1greater__equal.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/dc0/structCxxUtils_1_1fpcompare__fn_1_1greater__equalf.html">CxxUtils::fpcompare_fn::greater_equalf</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compare two FP numbers, working around x87 precision issues.  <a href="../../d1/dc0/structCxxUtils_1_1fpcompare__fn_1_1greater__equalf.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dbd/structCxxUtils_1_1fpcompare__fn_1_1less__equal.html">CxxUtils::fpcompare_fn::less_equal</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compare two FP numbers, working around x87 precision issues.  <a href="../../d5/dbd/structCxxUtils_1_1fpcompare__fn_1_1less__equal.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d11/structCxxUtils_1_1fpcompare__fn_1_1less__equalf.html">CxxUtils::fpcompare_fn::less_equalf</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compare two FP numbers, working around x87 precision issues.  <a href="../../d1/d11/structCxxUtils_1_1fpcompare__fn_1_1less__equalf.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="namespaces"></a>
Namespaces</h2></td></tr>
<tr class="memitem:de/d12/namespaceCxxUtils"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d12/namespaceCxxUtils.html">CxxUtils</a></td></tr>
<tr class="memdesc:de/d12/namespaceCxxUtils"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copy the elements of a sequence for which a predicate is true. <br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a0865c5fb9647b43166777aadcabb2d87"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><b>CxxUtils::fpcompare::equal</b> (double a, double b)</td></tr>
<tr class="memdesc:a0865c5fb9647b43166777aadcabb2d87"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compare two FP numbers, working around x87 precision issues.  <a href="#a0865c5fb9647b43166777aadcabb2d87">More...</a><br/></td></tr>
<tr class="separator:a0865c5fb9647b43166777aadcabb2d87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3212a2a06e0384678e7ab394418cbf49"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><b>CxxUtils::fpcompare::equal</b> (float a, float b)</td></tr>
<tr class="memdesc:a3212a2a06e0384678e7ab394418cbf49"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compare two FP numbers, working around x87 precision issues.  <a href="#a3212a2a06e0384678e7ab394418cbf49">More...</a><br/></td></tr>
<tr class="separator:a3212a2a06e0384678e7ab394418cbf49"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a096c5904dd129caefb3eb6a93c21d653"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><b>CxxUtils::fpcompare::greater</b> (double a, double b)</td></tr>
<tr class="memdesc:a096c5904dd129caefb3eb6a93c21d653"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compare two FP numbers, working around x87 precision issues.  <a href="#a096c5904dd129caefb3eb6a93c21d653">More...</a><br/></td></tr>
<tr class="separator:a096c5904dd129caefb3eb6a93c21d653"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30a5081a4d1b88cd09cb7f6756fc2fe8"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><b>CxxUtils::fpcompare::greater</b> (float a, float b)</td></tr>
<tr class="memdesc:a30a5081a4d1b88cd09cb7f6756fc2fe8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compare two FP numbers, working around x87 precision issues.  <a href="#a30a5081a4d1b88cd09cb7f6756fc2fe8">More...</a><br/></td></tr>
<tr class="separator:a30a5081a4d1b88cd09cb7f6756fc2fe8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a9fa58aa06b1b2afa0fe03a01c9948d"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><b>CxxUtils::fpcompare::less</b> (double a, double b)</td></tr>
<tr class="memdesc:a7a9fa58aa06b1b2afa0fe03a01c9948d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compare two FP numbers, working around x87 precision issues.  <a href="#a7a9fa58aa06b1b2afa0fe03a01c9948d">More...</a><br/></td></tr>
<tr class="separator:a7a9fa58aa06b1b2afa0fe03a01c9948d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8507a731bb5ad0716584538f15d82ea7"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><b>CxxUtils::fpcompare::less</b> (float a, float b)</td></tr>
<tr class="memdesc:a8507a731bb5ad0716584538f15d82ea7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compare two FP numbers, working around x87 precision issues.  <a href="#a8507a731bb5ad0716584538f15d82ea7">More...</a><br/></td></tr>
<tr class="separator:a8507a731bb5ad0716584538f15d82ea7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae62e91519a8322b4774e7ecf0a27a705"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><b>CxxUtils::fpcompare::greater_equal</b> (double a, double b)</td></tr>
<tr class="memdesc:ae62e91519a8322b4774e7ecf0a27a705"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compare two FP numbers, working around x87 precision issues.  <a href="#ae62e91519a8322b4774e7ecf0a27a705">More...</a><br/></td></tr>
<tr class="separator:ae62e91519a8322b4774e7ecf0a27a705"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18000651a35495e15cbceb0e4a8bb1da"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><b>CxxUtils::fpcompare::greater_equal</b> (float a, float b)</td></tr>
<tr class="memdesc:a18000651a35495e15cbceb0e4a8bb1da"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compare two FP numbers, working around x87 precision issues.  <a href="#a18000651a35495e15cbceb0e4a8bb1da">More...</a><br/></td></tr>
<tr class="separator:a18000651a35495e15cbceb0e4a8bb1da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88e80616613961580aede5e3a13bc456"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><b>CxxUtils::fpcompare::less_equal</b> (double a, double b)</td></tr>
<tr class="memdesc:a88e80616613961580aede5e3a13bc456"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compare two FP numbers, working around x87 precision issues.  <a href="#a88e80616613961580aede5e3a13bc456">More...</a><br/></td></tr>
<tr class="separator:a88e80616613961580aede5e3a13bc456"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28d1be1e7e67ace904d3ae1f32a64d0b"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><b>CxxUtils::fpcompare::less_equal</b> (float a, float b)</td></tr>
<tr class="memdesc:a28d1be1e7e67ace904d3ae1f32a64d0b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compare two FP numbers, working around x87 precision issues.  <a href="#a28d1be1e7e67ace904d3ae1f32a64d0b">More...</a><br/></td></tr>
<tr class="separator:a28d1be1e7e67ace904d3ae1f32a64d0b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Workaround x86 precision issues for FP inequality comparisons. </p>
<dl class="section author"><dt>Author</dt><dd>scott snyder </dd></dl>
<dl class="section date"><dt>Date</dt><dd>Sep 2008 The functions contained here can be used to work around one of the effects of the brain-damage of the x87 FPU.</dd></dl>
<p>Brief summary: If you're writing a comparison function for sort, where the comparison depends on computed floating-point values, eg:</p>
<div class="fragment"><div class="line">*    <span class="keywordtype">bool</span> <a class="code" href="../../da/d8a/namespaceAmg.html#a35d12bec7e92db7c1191b7827786adc7">compare</a> (IParticle* a, IParticle* b)</div>
<div class="line">*    { <span class="keywordflow">return</span> a-&gt;pt() &gt; b-&gt;pt(); }</div>
</div><!-- fragment --><p>then you should replace the comparison with a call to one of the functions in this file:</p>
<div class="fragment"><div class="line">*    <span class="keywordtype">bool</span> <a class="code" href="../../da/d8a/namespaceAmg.html#a35d12bec7e92db7c1191b7827786adc7">compare</a> (IParticle* a, IParticle* b)</div>
<div class="line">*    { <span class="keywordflow">return</span> CxxUtils::fpcompare::greater (a-&gt;pt(), b-&gt;pt()); }</div>
</div><!-- fragment --><p>Longer explanation:</p>
<p>An expression like this (where pt() returns a double):</p>
<div class="fragment"><div class="line">*    a-&gt;pt() &gt; b-&gt;pt()</div>
</div><!-- fragment --><p>is compiled (on x86) into a sequence like this: </p>
<pre class="fragment">call a-&gt;pt()
save result from FPU to a double stack temporary
call b-&gt;pt()
load the temporary back into the FPU
do the comparison
</pre><p>If pt() returns a result with the extra precision bits used (so that the value changes when rounded to a double), then it is possible for this comparison to return true for the case where a==b. This violates the assumptions that std::sort makes of the comparison function, and can cause a crash (possibly even silently wrong results!).</p>
<p>As a fix, we force both parameters into something that has been declared <code>volatile</code>. That forces them to be spilled to memory, ensuring that they are both correctly rounded for the declared data type. The comparison is then done on these rounded values.</p>
<p>We condition this on the parameter <code><b>FLT_EVAL_METHOD</b></code> being 2. This is defined in the C standard; a value of 2 means that all FP calculations are done as long double. For other cases, we leave out the <code>volatile</code> qualifiers; this should result in the functions being inlined completely away.</p>
<p>In addition to the free functions in the <code>CxxUtils::fpcompare</code> namespace. we define corresponding functionals in the <code>CxxUtils::fpcompare_fn</code> namespace.</p>
<p>It's also worth pointing out that exactly the same issue arises if one uses a floating-point value as the key for a STL associative container. In that case, this comparison instability may cause the container to become corrupted. While it's probably best to avoid using floats for associative container keys in the first place, if you do have to do that, you can work around this problem by using one of the above functionals as the container's comparison type. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Dec 1 2017 11:08:37 for RootCore Packages by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
